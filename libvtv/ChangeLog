2013-07-30   Benjamin Kosnik  <bkoz@redhat.com>

	* scripts/run-testsuite.sh (CXX): From VTV_CXXLINKFLAGS.

	* vtv_init.cc: Remove.
	
2013-07-30  Caroline Tice  <cmtice@google.com>
	    Benjamin Kosnik  <bkoz@redhat.com>

	* Makefile.am (AM_CXXFLAGS): Add
	Wl,-u_vtable_map_vars_start,-u_vtable_map_vars_end.
	* Makefile.in: Regenerate.

2013-07-29  Benjamin Kosnik  <bkoz@redhat.com>

	* doc/VtableVerificationFeatureProposal.pdf: Edits.

2013-07-29  Caroline Tice  <cmtice@google.com>

	* scripts/sum-vtv-counts.c: New. Summarize -fvtv-counts output log
	files.

2013-07-29  Benjamin Kosnik  <bkoz@redhat.com>

	* scripts/run-testsuite.sh (PASS_FAIL_TESTS): Comment out failing test.

2013-07-29  Benjamin Kosnik  <bkoz@redhat.com>

	* Makefile.am (libvtv_include_HEADERS, libvtv_la_SOURCES): Make
	conditional on enable-vtable-verify.
	* acinclude.m4 (LIBVTV_CONFIGURE): Add check for --enable-vtable-verify.
	* Makefile.in: Regenerate.
	* aclocal.m4: Regenerate.
	* configure: Regenerate.

	* scripts/run-testsuite.sh: Add LDFLAGS.

	* testsuite/Makefile.am (check-am): Conditionalize on
	enable_vtable_verify check.
	* testsuite/Makefile.in: Regenerate.

2013-07-26  Caroline Tice  <cmtice@google.com>

	* doc/VtableVerification-FeatureProposal.pdf: New.
	* doc/VtableVerification-PartialVerificationProblem.pdf: New.
	* doc/VtableVerification-UsersGuide.pdf: New.

2013-07-26  Benjamin Kosnik  <bkoz@redhat.com>

	* Makefile.am
	* Makefile.in: Regenerate.
	* acinclude.m4 (LIBVTV_CONFIGURE): New.
	* configure: Regenerate.
	* configure.ac: Call LIBVTV_CONFIGURE.
	* testsuite/Makefile.am: New.
	(check-script): New.
	* testsuite/Makefile.in: Regenerate.

2013-07-26  Caroline Tice  <cmtice@google.com>
	    Benjamin Kosnik  <bkoz@redhat.com>

	* scripts/run-testsuite.sh: Test harness.

2013-07-26  Caroline Tice  <cmtice@google.com>

	* testsuite/const_vtable.cc: Add tests.
	* testsuite/dataentry.cc: Same.
	* testsuite/dlopen.cc: Same.
	* testsuite/dlopen_mt.cc: Same.
	* testsuite/dup_name.cc: Same.
	* testsuite/environment-fail-32.s
	* testsuite/environment-fail-64.s
	* testsuite/environment.cc: Same.
	* testsuite/event-definitions.cc: Same.
	* testsuite/event-main.cc: Same.
	* testsuite/event-private.cc: Same.
	* testsuite/event-private.h
	* testsuite/event.h
	* testsuite/event.list
	* testsuite/field-test.cc: Same.
	* testsuite/mempool_negative.c
	* testsuite/mempool_positive.c
	* testsuite/nested_vcall_test.cc: Same.
	* testsuite/parts-test-extra-parts-views.cc: Same.
	* testsuite/parts-test-extra-parts-views.h
	* testsuite/parts-test-extra-parts.cc: Same.
	* testsuite/parts-test-extra-parts.h
	* testsuite/parts-test-main.cc: Same.
	* testsuite/parts-test-main.h
	* testsuite/parts-test.list
	* testsuite/povray-derived.cc: Same.
	* testsuite/register_pair.cc: Same.
	* testsuite/register_pair_inserts.cc: Same.
	* testsuite/register_pair_inserts_mt.cc: Same.
	* testsuite/register_pair_mt.cc: Same.
	* testsuite/replace-fail.cc: Same.
	* testsuite/so.cc: Same.
	* testsuite/temp_deriv.cc: Same.
	* testsuite/temp_deriv2.cc: Same.
	* testsuite/temp_deriv3.cc: Same.
	* testsuite/template-list-iostream.cc: Same.
	* testsuite/template-list.cc: Same.
	* testsuite/template-list2.cc: Same.
	* testsuite/thunk.cc: Same.
	* testsuite/thunk_vtable_map_attack.cc: Same.
	* testsuite/virtual_inheritance.cc: Same.

2013-07-24  Benjamin Kosnik  <bkoz@redhat.com>

	* vtv_rts.cc: Remove unused variables.
	* vtv_malloc.cc: Same.

2013-07-24  Benjamin Kosnik  <bkoz@redhat.com>

	* Makefile.am (SUBDIRS): Add testsuite.
	* Makefile.in: Regenerate.
	* testsuite/Makefile.am: Add.
	* testsuite/Makefile.in: Regenerate.

2013-07-24  Benjamin Kosnik  <bkoz@redhat.com>

	* Makefile.am.bkoz: Remove merge mistake.

2013-07-23  Benjamin Kosnik  <bkoz@redhat.com>

	* vtv_rts.h: Format.
	* vtv_utils.h: Adjust include path.

2013-07-15  Benjamin Kosnik  <bkoz@redhat.com>

	* vtv_stubs.cc: Move to libsupc++.
	* vtv_init.cc: Move functionality to libgcc_s.
	* Makefile.am (vtv_stubs_sources): Remove.
	(libvtv_stubs_la_SOURCES): Remove.
	(libvtv_init_la_SOURCES): Remove.
	* Makefile.in: Regenerate.

2013-07-15  Caroline Tice  <cmtice@google.com>

	* vtv_fail.h (__vtv_really_fail): Add default, noreturn, nothrow
	attributes.
	(__vtv_verify_fail, __vtv_verify_fail_debug): Add nothrow attribute.
	* vtv_malloc.cc (VTV_count_mmapped_pages): To __vtv_count_mmapped_pages.
	Add debugging hook when VTV_DEBUG defined.
	(VTV_malloc_protect): To __vtv_malloc_protect.
	(VTV_malloc_unprotect): To __vtv_malloc_unprotect.
	(VTV_malloc_init): To __vtv_malloc_init.
	(VTV_malloc): To __vtv_malloc.
	(VTV_free): To __vtv_free.
	(VTV_malloc_dump_stats): To __vtv_malloc_dump_stats.
	(VTV_malloc_stats): To __vtv_malloc_dump_stats.
	* vtv_malloc.h: Adjust for name changes as immediately above.
	* vtv_map.h (insert_only_hash_map): Mark get and equals member
	functions inline.
	* vtv_rts.cc: Add debug_functions, debug_init, debug_verify_vtable
	when VTV_DEBUG. Adjust names for interface changes.
	(VTV_protect_vtable_vars): To vtv_protect_vtable_vars.
	(log_error_message): Remove.
	(__vtv_verify_fail_debug): Add.
	(__vtv_verify_fail): Add.
	(vtv_fail): Add.
	* vtv_utils.cc (__vtv_open_log, __vtv_add_to_log)
	(__vtv_log_verification): Uglify to declarations.
	* vtv_utils.h (vtv_failures_log_fd): New.
	(vtv_open_log): Uglify to __vtv_open_log.
	(vtv_add_to_log): Uglify to __vtv_add_to_log.
	(__vtv_log_verification): New.

2013-07-11  Benjamin Kosnik  <bkoz@redhat.com>

	* libvtv/vtv_rts.cc: Remove unused variables.

2013-07-05  Benjamin Kosnik  <bkoz@redhat.com>

	* acinclude.m4: Fix configure whitespace errors.
	* libsupc++/Makefile.am (libvtv_init): Add back as
	toolexeclib_LTLIBRARIES.
	* configure: Regenerate.
	* libsupc++/Makefile.in: Same.

	* libsupc++/vtv_rts.cc: Fix typo.

2013-07-01  Benjamin Kosnik  <bkoz@redhat.com>

	* fragment.am: Remove VTV_CXXLINKFLAGS, VTV_CXXFLAGS.
	* acinclue.m4 (GLIBCXX_ENABLE_VTABLE_VERIFY): Set VTV_CXXFLAGS,
	VTV_CXXLINKFLAGS, and AC_SUBST value.
	* testsuite/lib/libstdc++.exp (libstdc++_init): Set/use cxxvtvflags.
	(proc_v3_target_compile): Same.
	* scripts/testsuite_flags.in (--cxxvtvflags): New.
	* config.h.in: Regenerate.
	* configure: Regenerate.
	* Makefile.in: Same.
	* doc/Makefile.in: Same.
	* include/Makefile.in: Same.
	* libsupc++/Makefile.in: Same.
	* po/Makefile.in: Same.
	* python/Makefile.in: Same.
	* src/Makefile.in: Same.
	* src/c++11/Makefile.in: Same.
	* src/c++98/Makefile.in: Same.
	* testsuite/Makefile.in: Same.

2013-06-16  Caroline Tice  <cmtice@google.com>

	* configure: Regenerate.
	* src/Makefile.in: Regenerate.
	* src/c++98/Makefile.am (EXTRA_VTV_LDFLAGS, LIBVTV_FLAGS, VTV_CXXFLAGS):
	New definitions, conditioned on ENABLE_VTABLE_VERIFY.
	(AM_CXXFLAGS):  Add VTV_CXXFLAGS to list.
	(CXXLINK): Add LIBVTV_FLAGS.
	* src/c++11/Makefile.am: Ditto.
	* src/c++98/Makefile.in: Regenerate.
	* src/Makefile.am (libvtv__la_LIBADD): Add definition, conditioned on
	ENABLE_VTABLE_VERIFY.
	(LIBVTV_FLAGS): Add definition, conditioned on ENABLE_VTABLE_VERIFY.
	(libstdc___la_LDFLAGS): Add 'Wl,-u_vtable_map_var_start,
	-u_vtable_map_var_end' if ENABLE_VTABLE_VERIFY is true.
	(AM_CXXFLAGS): Add VTV_CXXFLAGS.
	(CXXLINK):  Add LIBVTV_FLAGS.
	* src/c++11/Makefile.in: Regenerate.
	* configure.ac (predep_objects_CXX): Add libgcc/vtv_start.o, if
	enable_vtable_verify is yes.
	(postdep_objects_CXX): Add libgcc/vtv_end.o if enable_vtable_verify is
	yes.
	(GLIBCXX_ENABLE_VTABLE_VERIFY): New definition.
	* libsupc++/vtv_set.h:  New file.
	* libsupc++/vtv_stubs.cc:  New file.
	* libsupc++/vtv_utils.cc:  New file.
	* libsupc++/vtv_utils.h:  New file.
	* libsupc++/vtv_init.cc:  New file.
	* libsupc++/vtv_malloc.cc:  New file.
	* libsupc++/Makefile.am (sources):  Add vtv_rts.cc, vtv_malloc.cc and
	vtv_utils.cc to the list.
	(vtv_init_sources, vtv_stubs_soruces, libvtv_init_la_sources,
	libvtv_stubs_la_sources):  New definitions.
	(toolexeclib_LTLIBRARIES):  Add libvtv_init.la and libvtv_stubs.la
	* libsupc++/Makefile.in:  Regenerate.
	* libsupc++/vtv_rts.cc:  New file.
	* libsupc++/vtv_malloc.h:  New file.
	* libsupc++/vtv_rts.h:  New file.
	* libsupc++/vtv_fail.h:  New file.
	* libsupc++/vtv_map.h:  New file.
	* config/abi/pre/gnu.ver:  Add vtable verification runtime functions to
	the list of globally visible symbols.
	* acinclude.m4: Add GLIBCXX_ENABLE_VTABLE_VERIFY option and comments.
